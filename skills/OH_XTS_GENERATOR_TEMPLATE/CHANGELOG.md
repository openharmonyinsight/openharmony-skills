# OH_XTS_GENERATOR_TEMPLATE 更新日志

> **OpenHarmony XTS 测试用例通用生成模板 - 版本更新记录**

## 当前版本信息

- **版本**: 1.12.0
- **创建日期**: 2025-01-31
- **更新日期**: 2026-02-06
- **兼容性**: OpenHarmony API 10+
- **基于**: OH_XTS_GENERATOR v1.7.0

---

## 版本历史

### v1.12.0 (2026-02-06)

**重要更新**：Linux 编译工作流模块化重构 v2.0.0

#### 核心变更

**Linux 编译工作流升级到 v2.0.0**：大规模模块化拆分
- 拆分为 5 个独立模块（主文件 + 4 个功能模块）
- 主文件大小减少 49%（716 行 → 365 行）
- 新增工作流程图和快速参考表
- 提高可维护性和用户体验

#### 新增编译模块

1. **主工作流**（`build_workflow_linux.md`，365 行）
   - 核心编译工作流，包含编译命令、输出验证、完整示例
   - 必需模块，每次使用编译功能时加载

2. **环境准备**（`linux_compile_env_setup.md`，476 行）
   - 编译环境准备（操作系统要求、工具链安装、SDK下载、环境验证）
   - 按需加载：首次编译时或用户要求准备环境时

3. **预编译清理**（`linux_prebuild_cleanup.md`，278 行）
   - 预编译清理指南（清理必要性、清理步骤、清理验证、故障排查）
   - 按需加载：编译前必须执行

4. **BUILD.gn 配置**（`build_gn_config.md`，521 行）
   - BUILD.gn 配置指南（基本结构、关键配置字段、Stage/FA模型配置、辅助工程配置）
   - 按需加载：用户要求配置 BUILD.gn 时

5. **问题排查**（`linux_compile_troubleshooting.md`，418 行）
   - 编译问题排查指南（常见错误、编译优化、日志分析、高级排查）
   - 按需加载：用户遇到编译错误时

#### 文档更新

- 更新：SKILL.md 重要注意事项第6条（编译环境检测）添加模块化架构说明
- 更新：skill_config.json `build_workflow_linux` 节点添加模块化配置
- 更新：所有模块文档添加完整的说明和使用指南

#### 改进原因

提高 Linux 编译工作流的可维护性和用户体验，通过模块化设计让用户按需加载相关模块，减少不必要的信息加载。

---

### v1.11.0 (2026-02-05)

**重要更新**：@tc 注释块和 hypium 导入规范（强制要求）

#### 新增功能

**第六章 - @tc 注释块规范** (`_common.md`)
- 6.1 @tc 注释块标准格式
- 6.2 @tc 注释块字段说明
- 6.3 @tc.name 命名规范（小驼峰命名，必须与 it() 参数一致）
- 6.4 @tc.number 编号规范
- 6.5 @tc.desc 描述规范
- 6.6 字段值对照关系（@tc 与 it() 参数必须一致）
- 6.7 实际项目示例（401错误码、17000002错误码）

**第七章 - hypium 导入规范** (`_common.md`)
- 7.1 标准 hypium 导入格式
- 7.2 导入项说明
- 7.3 导入检查清单
- 7.4 常见错误及修复
- 7.5 自动检测和修复逻辑

#### 文档更新

- 更新：通用配置 `_common.md` 升级至 v1.8.0
- 更新：核心工作流程新增步骤6（添加 @tc 注释块）和步骤7（检查 hypium 导入）
- 更新：重要注意事项新增第1条（@tc 注释块规范）和第2条（hypium 导入规范）

#### 参考项目

基于实际项目 `testfwk/uitest_errorcode` 的规范化经验：
- 修复了 231 个测试用例的 @tc 注释块
- 修复了 4 个文件的 hypium 导入问题
- 统一了命名规范（小驼峰命名）
- 建立了完整的 @tc 注释块标准

#### 改进原因

确保所有测试用例都符合 XTS 规范，包含完整的 @tc 注释块和正确的 hypium 导入。

---

### v1.10.1 (2026-02-05)

**更新**：任务完成输出规范优化

#### 变更内容

- 修改：测试覆盖统计和覆盖率对比改为可选输出项
- 新增：参考资源部分（已有用例路径、代码风格分析）为必须输出项
- 新增：输出说明，明确区分必须输出和可选输出项

#### 改进原因

简化默认输出内容，测试覆盖统计仅在用户明确要求时输出。

---

### v1.10.0 (2026-02-05)

**重要更新**：测试用例命名规范（强制要求）

#### 新增功能

- it() 函数第一个参数必须使用小驼峰命名（camelCase）
- 禁止使用大写下划线命名（如 `UiTest_On_text_401`）
- it() 函数第二个参数必须使用完整格式
- 禁止使用 `0` 作为第二个参数
- 命名转换规则和示例（6个转换示例）

#### 文档更新

- 完善：通用配置 `_common.md` 升级至 v1.7.0
  - 添加详细的命名规范说明
  - 添加正确示例和错误示例对比
  - 添加代码示例展示正确的 it() 函数用法

#### 参考项目

基于实际项目 `testfwk/uitest_errorcode` 的命名规范修改经验。

#### 改进原因

统一测试用例命名规范，提高代码可读性和一致性。

---

### v1.9.3 (2026-02-04)

**新增**：工程文件修改限制（强制要求）

#### 新增功能

- 严格禁止修改工程目录中的配置文件
- 仅允许修改 `entry/src/ohosTest/ets/test/` 中的内容
- 详细列出禁止修改的配置文件列表
- 编译错误处理原则
- 违反限制的后果说明

#### 文档更新

- 更新：核心工作流程第8步添加"禁止修改工程配置文件"提示

#### 改进原因

保护工程结构完整性，避免因修改配置文件导致的问题。

---

### v1.9.2 (2026-02-02)

**重要更新**：Linux 编译工作流强调必须使用 `build.sh` 脚本

#### 新增功能

- Linux 编译工作流文档头部添加重要提示框
- 明确说明 Linux 环境下不要使用 `hvigorw` 命令
- 新增 1.3 节"编译方式说明"，详细对比 Linux 和 Windows 编译方式

#### 文档更新

- 完善：Linux 编译工作流模块强调 `build.sh` 是唯一正确的编译方式
- 完善：SKILL.md 重要注意事项第6条强调 Linux 使用 build.sh
- 完善：skill_config.json 添加 Linux 编译重要提示信息

#### 改进原因

`build.sh` 是 XTS 测试工程的官方编译脚本，能正确处理 BUILD.gn 配置；`hvigorw` 是 Windows/DevEco Studio 的编译工具，不适用于 Linux 环境。

---

### v1.9.1 (2026-02-02)

**更新**：Windows 编译工作流模块升级至 v2.1.0

#### 新增功能

- DevEco Studio IDE 编译方式（推荐新手）
- 命令行编译方式 hvigorw.bat（推荐自动化）
- 完整的测试执行流程和命令格式
- Hypium 测试框架结果解析
- 多测试套批量执行和汇总统计
- 完整自动化脚本 run_all_tests.ps1
- 测试结果 JSON 报告生成
- 故障排除和最佳实践

#### 文档更新

- 完善：skill_config.json 添加 Windows 编译工作流特性列表

#### 验证

基于实际项目测试经验完善文档。

---

### v1.9.0 (2026-01-14)

**新增**：参考 API 文档功能（强制要求）

#### 核心功能

- 解析 API 时必须同时参考 .d.ts 文件和 API 文档资料
- API 文档路径配置（主路径、备用路径、当前目录）
- 备用文档路径：/mnt/data/c00810129/oh_0130/docs/

#### 文档类型和位置

- API 参考文档
- 错误码文档
- 指南文档
- 示例文档

#### 文档内容参考清单

- 错误码说明：详细描述、触发条件、处理方式
- 使用场景：API 的适用场景和典型用例
- 使用限制：约束条件、权限要求、版本限制
- 使用示例：官方示例代码和最佳实践

#### 文档查找策略

1. 按子系统查找（从子系统配置读取）
2. 根据 API 名称在 docs 仓中查找（全文搜索）
3. 按 Kit 包名查找（辅助）

#### 核心工作流程增强

- 增强：核心工作流程第2步 - 解析 API 定义（增强版）
- 新增：查找并解析 API 文档（强制要求）
- 新增：综合分析 .d.ts 和文档信息

#### 文档更新

- 更新：通用配置 (_common.md) 升级至 v1.6.0

---

### v1.8.0 (2026-01-14)

**新增**：参考已有用例功能（强制要求）

#### 核心功能

- 生成新用例时必须参考已有用例的代码风格和规范
- 支持指定测试套路径，优先分析该测试套的已有用例
- 默认参考路径配置：${OH_ROOT}/test/xts/acts/

#### 参考内容清单

1. 代码风格：缩进、命名格式、注释风格
2. 测试结构：describe/it 嵌套、beforeAll/afterAll 使用
3. 用例编号：SUB_xxx 格式、序号规则
4. 断言方式：expect 使用模式、断言类型
5. 错误处理：try-catch 结构、错误码验证方式
6. 导入语句：import 顺序、导入方式

#### 核心工作流程更新

- 新增：核心工作流程第3步 - 参考已有用例
- 完善：步骤5（生成测试用例）应用已有用例的代码风格
- 完善：步骤6（格式化和验证）对比已有用例风格
- 完善：步骤9（输出报告）说明参考的已有用例路径和风格分析

#### 文档更新

- 更新：通用配置 (_common.md) 升级至 v1.5.0

---

### v1.7.0 (2026-01-14)

**更新**：通用错误码参考

#### 错误码更新

- 新增：203 错误码 - 企业管理策略禁止使用此系统功能
- 完善：201、202、401、801 错误码 - 添加详细的错误描述、可能原因、处理步骤

#### 新增功能

- 通用错误码速查表

#### 文档更新

- 更新：通用配置 (_common.md) 升级至 v1.4.0

---

### v1.6.0 (2025-02-02)

**新增**：testfwk 子系统配置

#### 核心功能

- 新增：`references/subsystems/testfwk/_common.md` - TestFwk 子系统通用配置
- 新增：string 参数特殊规则 - 空字符串 '' 是合法参数，不会抛出错误码 401
- 新增：testfwk 参数类型测试规则（与通用规则不同）
- 新增：空字符串合法参数测试模板

#### 配置更新

- 更新：skill_config.json 添加 testfwk 子系统映射和特殊规则
- 更新：api_kit_mapping 添加 @kit.TestKit 映射

#### 重要说明

为 testfwk 子系统生成测试时，不要为空字符串生成 ERROR_401 测试用例。

---

### v1.5.0 (2025-02-02)

**新增**：ArkTS 子系统配置

#### 核心功能

- 新增：`references/subsystems/ArkTS/_common.md` - ArkTS 子系统通用配置
- 新增：ArkTS 编译错误级别规则汇总（70+ 条规则）
- 新增：明确 ArkTS 不支持的语法特性（无需生成测试用例）
- 新增：ArkTS 特有测试规则和代码模板

#### 参考文档

`/mnt/data/c00810129/.claude/skills/ArkTS_Dyn_Syntax_Rules_Complete.md`

---

### v1.4.0 (2025-02-02)

**更新**：异常场景断言优化

#### 变更内容

- 更新：异常场景断言优先使用 `err.code` 而非 `err.message`
- 更新：用例名称禁止使用特殊标点符号（如 `[]`、`.` 等）

#### 新增功能

- 新增：代码逻辑走不到的分支使用 `expect().assertFail()` 做断言终结

#### 完善

- 完善：async 的用法，仅在测试业务中存在异步场景时修饰
- 完善：done() 的用法，仅在不使用 await 的业务异步中做回调结束标识

#### 重构

- 重构：异步API测试模板，提供 async/await 和 .then()/.catch() 两种方式

#### 文档更新

- 更新：通用配置 (_common.md) 升级至 v1.3.0

---

### v1.3.4 (2025-01-31)

**修正**：Linux 环境编译命令描述错误

#### 变更内容

- 更新：Linux 环境使用 `test/xts/acts/build.sh` 脚本进行编译
- 完善：编译命令示例更新为 `./test/xts/acts/build.sh product_name=rk3568 system_size=standard suite=test_name`

---

### v1.3.3 (2025-01-31)

**新增**：编译环境检测强制要求

#### 核心功能

- 新增：核心工作流程添加"编译验证"步骤
- 新增：重要注意事项第6条 - 编译环境检测（强制）

#### 完善

- 完善：提供 Linux 和 Windows 环境检测方法
- 完善：提供不同环境下的编译方案选择指导

#### 改进

明确编译前必须进行环境检测的要求。

---

### v1.3.2 (2025-01-31)

**重构**：编译工作流拆分

#### 核心变更

- 重构：将编译工作流拆分为 Linux 和 Windows 两个独立模块
- 新增：`modules/L2_Analysis/build_workflow_linux.md` - Linux 编译工作流
- 新增：`modules/L2_Analysis/build_workflow_windows.md` - Windows 编译工作流
- 新增：`references/ArkTS_Dynamic_Syntax_Rules.md` - ArkTS-Dynamic 语法参考

#### 优化

- 优化：编译相关模块按平台分离，职责更加清晰
- 新增：平台特定的编译指导（PowerShell vs Bash）
- 改进：`build_and_compile` 模式支持平台特定模块加载

---

### v1.3.1 (2025-01-31)

**重构**：子系统配置采用文件夹结构

#### 核心变更

- 重构：子系统配置采用文件夹结构（`{Subsystem}/`）
- 新增：子系统通用配置（`{Subsystem}/_common.md`）
- 新增：模块级配置（`{Subsystem}/{ModuleName}.md`）
- 新增：配置继承机制（全局 → 子系统 → 模块）
- 新增：模块映射配置（子系统声明包含的模块及其API声明文件）

#### 优化

- 优化：配置文件组织更清晰，支持模块级特有配置

#### 示例

添加 ArkUI 和 ArkWeb 的完整配置示例：
- ArkUI: _common.md, Component.md, Animator.md, Router.md
- ArkWeb: _common.md, Web.md, WebViewController.md

---

### v1.2.0 (2025-01-31)

**新增**：工程配置解析器模块

#### 核心功能

- 新增：`modules/L2_Analysis/project_parser.md` - 工程配置解析器模块

#### 优化

- 优化：将工程语法类型识别详细内容移至 project_parser.md
- 优化：API 类型判断详细内容已在 api_parser.md 中
- 优化：SKILL.md 和 _common.md 只保留概述和引用

#### 改进

完善模块化架构，L2_Analysis 层包含完整的解析功能。

---

### v1.1.0 (2025-01-31)

**新增**：ArkTS 语法类型识别

#### 核心功能

- 新增：ArkTS 语法类型识别章节
- 新增：API 类型判断方法（动态 API vs 静态 API）
- 新增：工程语法类型识别方法（build-profile.json5）
- 新增：测试用例生成策略（根据工程类型和 API 类型）
- 新增：文件命名规则（静态语法 vs 动态语法）
- 新增：新增测试工程时的类型确认流程

#### 文档更新

- 更新：重要注意事项，添加 ArkTS 语法类型相关注意事项
- 更新：通用配置 _common.md，添加 1.5 ArkTS 语法类型章节

---

### v1.0.0 (2025-01-31)

**初始版本**

- 基于OH_XTS_GENERATOR创建通用模板版本
- 提供完整的测试用例生成工作流
- 支持模块化架构（L1/L2/L3）
- 支持分层配置系统（通用配置 + 子系统特有配置）
- 支持灵活扩展机制
